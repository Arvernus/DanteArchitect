<!doctype html>
<html lang="de">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Dante Architect – Mapping Matrix</title>
  <style>
    :root{
      --grid-border:#ddd; --muted:#666; --head:#f7f7f7; --accent:#2979ff;
      --chip:#eef3ff; --dot:#222; --cell-bg:#fff; --cell-hover:#f2f7ff;
    }
    *{ box-sizing: border-box; }
    body{ margin:0; font-family: system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif; color:#111; height:100dvh; display:flex; flex-direction:column; }
    header{ padding:10px 12px; border-bottom:1px solid var(--grid-border); display:flex; gap:10px; align-items:center; flex-wrap:wrap; }
    header h1{ margin:0; font-size:16px; }
    header .spacer{ flex:1 1 auto; }
    a.btn, button.btn{
      appearance:none; border:1px solid #bbb; background:#f7f7f7; padding:6px 10px; border-radius:6px; cursor:pointer; font-size:14px; text-decoration:none; color:inherit;
    }
    .toolbar{ display:flex; gap:12px; align-items:center; flex-wrap:wrap; }

    .chip{ background:var(--chip); border:1px solid #c8d6ff; padding:4px 8px; border-radius:999px; font-size:12px; }

    .wrap{ flex:1 1 auto; min-height:0; display:flex; flex-direction:column; }
    .filters{ padding:8px 12px; border-bottom:1px solid var(--grid-border); display:grid; grid-template-columns: repeat(4, minmax(180px, 1fr)); gap:8px; }
    .filters label{ font-size:12px; color:var(--muted); display:block; margin-bottom:3px; }
    .filters input[type="text"]{ width:100%; padding:6px 8px; border:1px solid #ccc; border-radius:6px; }
    .filters .check{ display:flex; align-items:center; gap:6px; font-size:13px; }

    .matrix-wrap{ flex:1 1 auto; min-height:0; overflow:auto; position:relative; background:white; }
    table.matrix{ border-collapse: separate; border-spacing:0; width:max-content; min-width:100%; }
    .matrix th, .matrix td{ border:1px solid var(--grid-border); padding:6px 8px; background:var(--cell-bg); }
    .matrix thead th{ background: var(--head); position: sticky; top: 0; z-index: 3; }
    .matrix .rowhead{ position: sticky; left: 0; z-index: 2; background: var(--head); }
    .matrix .rowchan{ position: sticky; left: 220px; z-index: 2; background: var(--head); }
    .matrix .top-left-0{ position: sticky; left: 0; z-index: 4; }
    .matrix .top-left-1{ position: sticky; left: 220px; z-index: 4; }
    .matrix .group{ text-align:left; font-weight:600; }
    .matrix .editable{ outline:1px dashed transparent; }
    .matrix .editable[contenteditable="true"]{ outline-color:#bcd; background:#fff; }
    .matrix .tx-chan, .matrix .rx-chan{ font-variant-numeric: tabular-nums; }
    .matrix .cell{ width: 28px; height: 24px; text-align:center; vertical-align:middle; cursor: default; }
    .matrix .cell.editable:hover{ background: var(--cell-hover); cursor: pointer; }
    .dot{ width:10px; height:10px; border-radius:50%; background:var(--dot); display:inline-block; }

    /* Toggle (wiederverwendet aus Index) */
    .toggle{ display:inline-flex; align-items:center; gap:8px; cursor:pointer; user-select:none; }
    .toggle input{ display:none; }
    .toggle .switch{
      width:34px; height:18px; border-radius:999px; background:#cfd8dc; position:relative; transition:.15s;
    }
    .toggle .knob{
      width:16px; height:16px; border-radius:50%; background:#fff; position:absolute; top:1px; left:1px; box-shadow: 0 1px 2px rgba(0,0,0,.2); transition:.15s;
    }
    .toggle input:checked + .switch{ background: #82b1ff; }
    .toggle input:checked + .switch .knob{ left:17px; }

    .hint{ color:var(--muted); font-size:12px; padding:6px 12px; }
    .warn{ color:#b00020; }
  </style>
</head>
<body>
  <header>
    <a class="btn" href="./Index.html">← Übersicht</a>
    <h1>Mapping Matrix</h1>
    <span class="chip" id="presetNameChip">kein Preset geladen</span>
    <div class="spacer"></div>
    <div class="toolbar">
      <!-- Bearbeiten: Abonnements (zweizeilig) -->
      <label class="toggle" title="Abonnements setzen/entfernen erlauben">
        <input id="toggleSubs" type="checkbox" />
        <span class="switch"><span class="knob"></span></span>
        <span style="display:inline-flex; flex-direction:column; line-height:1.05;">
          <span>Bearbeiten</span>
          <span>Abonnements</span>
        </span>
      </label>

      <!-- Bearbeiten: Namen/Labels -->
      <label class="toggle" title="Gerätenamen & Kanalbezeichnungen bearbeiten">
        <input id="toggleNames" type="checkbox" />
        <span class="switch"><span class="knob"></span></span>
        <span>Namen/Labels</span>
      </label>

      <button class="btn" id="btnSaveBack">Speichern & Zurück</button>
    </div>
  </header>

  <div class="wrap">
    <!-- kompakte Filter -->
    <div class="filters">
      <div>
        <label for="fTx">Filter TX (Gerät ODER Kanal)</label>
        <input id="fTx" type="text" placeholder="z.B. Stagebox, Kick, ..." />
      </div>
      <div>
        <label for="fRx">Filter RX (Gerät ODER Kanal)</label>
        <input id="fRx" type="text" placeholder="z.B. FOH, L, R ..." />
      </div>
      <div class="check">
        <input id="onlyRowsWithSubs" type="checkbox" />
        <label for="onlyRowsWithSubs">Nur RX-Zeilen mit Subscriptions (momentane Auswahl einfrieren)</label>
      </div>
      <div class="check">
        <input id="onlyColsWithSubs" type="checkbox" />
        <label for="onlyColsWithSubs">Nur TX-Spalten mit Subscriptions (momentane Auswahl einfrieren)</label>
      </div>
    </div>

    <div class="matrix-wrap" id="matrixWrap">
      <table class="matrix" id="matrix">
        <thead id="thead"></thead>
        <tbody id="tbody"></tbody>
      </table>
    </div>
    <div class="hint" id="hint"></div>
  </div>

  <script src="./Matrix.js"></script>
</body>
</html>